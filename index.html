<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Password Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="manifest" href="manifest.json" />
<meta name="theme-color" content="#007bff" />
<link rel="apple-touch-icon" href="icons/icon-192.png" />
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.4s ease-out',
                        'bounce-in': 'bounceIn 0.6s ease-out',
                        'pulse-soft': 'pulseSoft 2s ease-in-out infinite',
                        'theme-switch': 'themeSwitch 0.3s ease-in-out',
                        'splash-fade-out': 'splashFadeOut 0.8s ease-in-out forwards',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' }
                        },
                        slideUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' }
                        },
                        bounceIn: {
                            '0%': { opacity: '0', transform: 'scale(0.3)' },
                            '50%': { opacity: '1', transform: 'scale(1.05)' },
                            '70%': { transform: 'scale(0.9)' },
                            '100%': { opacity: '1', transform: 'scale(1)' }
                        },
                        pulseSoft: {
                            '0%, 100%': { opacity: '1' },
                            '50%': { opacity: '0.7' }
                        },
                        themeSwitch: {
                            '0%': { transform: 'rotate(0deg) scale(1)' },
                            '50%': { transform: 'rotate(180deg) scale(1.1)' },
                            '100%': { transform: 'rotate(360deg) scale(1)' }
                        },
                        splashFadeOut: {
                            '0%': { opacity: '1' },
                            '100%': { opacity: '0', visibility: 'hidden' }
                        }
                    }
                }
            }
        };
    </script>
</head>
<body class="bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-gray-900 dark:via-blue-900 dark:to-purple-900 min-h-screen transition-all duration-500">
    
    <!-- Splash Screen -->
    <div id="splashScreen" class="fixed inset-0 bg-white flex flex-col items-center justify-center z-50">
        <div class="animate-bounce mb-6">
            <i class="fas fa-shield-alt text-blue-600 text-6xl animate-pulse-soft"></i>
        </div>
        <h1 class="text-3xl font-bold text-gray-800 mb-2 text-center">Vaulta<br>Password Generator</h1>
        <div class="text-gray-600 text-lg font-medium flex items-center">
            Made with <span class="text-red-500 mx-2 text-xl">❤</span> by Yasir Divde
        </div>
    </div>

    <!-- Dark Mode Toggle - Fixed to Top Left -->
    <button id="themeToggle" class="absolute top-2 left-4 p-2 sm:p-3 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110 active:scale-95 border dark:border-gray-600 z-40">
        <i id="themeIcon" class="fas fa-moon text-lg sm:text-xl transition-transform duration-300"></i>
    </button>

    <div class="container mx-auto px-3 sm:px-4 lg:px-6 py-4 sm:py-6 lg:py-8">
        <!-- Header -->
        <div class="text-center mb-6 sm:mb-8 animate-fade-in">
            <div class="flex flex-col items-center max-w-4xl mx-auto mb-4">
                <h1 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-800 dark:text-gray-100 mb-2 transition-all duration-300">
                    <i class="fas fa-shield-alt text-blue-600 dark:text-blue-400 mr-2 sm:mr-3 animate-pulse-soft"></i>
                    Password Generator
                </h1>
                <p class="text-sm sm:text-base text-gray-600 dark:text-gray-300 transition-all duration-300 mb-2">Generate secure passwords and manage your vault</p>
                <div class="text-xs sm:text-sm text-gray-500 dark:text-gray-400 flex items-center">
                    Made with <span class="text-red-500 mx-1">❤</span> by Yasir Divde
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="max-w-6xl mx-auto">
            <!-- Navigation Tabs -->
            <div class="flex bg-white dark:bg-gray-800 rounded-xl shadow-sm mb-4 sm:mb-6 p-1 animate-slide-up transition-all duration-300 hover:shadow-md border dark:border-gray-700">
                <button id="generatorTab" class="flex-1 py-2 sm:py-3 px-3 sm:px-6 rounded-lg bg-blue-600 text-white font-medium transition-all duration-300 transform hover:scale-105 active:scale-95">
                    <i class="fas fa-key mr-1 sm:mr-2 text-sm sm:text-base"></i>
                    <span class="text-sm sm:text-base">Generator</span>
                </button>
                <button id="vaultTab" class="flex-1 py-2 sm:py-3 px-3 sm:px-6 rounded-lg text-gray-600 dark:text-gray-300 font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-300 transform hover:scale-105 active:scale-95">
                    <i class="fas fa-vault mr-1 sm:mr-2 text-sm sm:text-base"></i>
                    <span class="text-sm sm:text-base">My Vault</span>
                </button>
            </div>

            <!-- Generator Section -->
            <div id="generatorSection" class="space-y-4 sm:space-y-6">
                <!-- Password Output -->
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 sm:p-6 animate-slide-up transition-all duration-300 hover:shadow-xl border dark:border-gray-700">
                    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 space-y-3 sm:space-y-0">
                        <h2 class="text-lg sm:text-xl font-semibold text-gray-800 dark:text-gray-100">Generated Password</h2>
                        <div id="strengthIndicator" class="flex items-center space-x-2">
                            <span class="text-xs sm:text-sm font-medium text-gray-600 dark:text-gray-400">Strength:</span>
                            <div id="strengthBar" class="w-16 sm:w-24 h-2 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden">
                                <div id="strengthFill" class="h-full transition-all duration-500 ease-out"></div>
                            </div>
                            <span id="strengthText" class="text-xs sm:text-sm font-medium"></span>
                        </div>
                    </div>
                    
                    <div class="flex flex-col sm:flex-row items-stretch space-y-3 sm:space-y-0 sm:space-x-3">
                        <input type="text" id="passwordOutput" 
                               class="flex-1 p-3 sm:p-4 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg font-mono text-sm sm:text-lg text-gray-800 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 hover:bg-gray-100 dark:hover:bg-gray-600" 
                               placeholder="Click generate to create password" readonly>
                        <div class="flex space-x-2 sm:space-x-3">
                            <button id="copyBtn" 
                                    class="flex-1 sm:flex-none px-4 sm:px-6 py-3 sm:py-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all duration-300 flex items-center justify-center space-x-2 transform hover:scale-105 active:scale-95 shadow-md hover:shadow-lg">
                                <i class="fas fa-copy text-sm"></i>
                                <span class="text-sm sm:text-base">Copy</span>
                            </button>
                            <button id="generateBtn" 
                                    class="flex-1 sm:flex-none px-4 sm:px-6 py-3 sm:py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all duration-300 flex items-center justify-center space-x-2 transform hover:scale-105 active:scale-95 shadow-md hover:shadow-lg">
                                <i class="fas fa-refresh text-sm"></i>
                                <span class="text-sm sm:text-base">Generate</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Options Panel -->
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 sm:p-6 animate-slide-up transition-all duration-300 hover:shadow-xl border dark:border-gray-700" style="animation-delay: 0.1s">
                    <h3 class="text-base sm:text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4">Password Options</h3>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6">
                        <!-- Length Setting with Single Blue Background -->
                        <div class="space-y-3 sm:space-y-4">
                            <div class="flex items-center justify-between">
                                <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Password Length</label>
                                <span id="lengthValue" class="text-sm font-bold text-blue-600 dark:text-blue-400 bg-blue-100 dark:bg-blue-900 px-2 py-1 rounded-full transition-all duration-300">12</span>
                            </div>
                            
                            <!-- Enhanced Slider Container with Single Blue Background -->
                            <div class="relative">
                                <div id="sliderBackground" class="absolute inset-0 h-3 rounded-lg overflow-hidden bg-blue-200 dark:bg-blue-800 opacity-30"></div>
                                <div id="sliderFill" class="absolute top-0 left-0 h-3 rounded-lg bg-blue-500 transition-all duration-300 opacity-60"></div>
                                <input type="range" id="lengthSlider" min="4" max="128" value="12" 
                                       class="relative w-full h-3 bg-transparent rounded-lg appearance-none cursor-pointer slider transition-all duration-300 z-10">
                            </div>
                            
                            <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400">
                                <span>4</span>
                                <span>128</span>
                            </div>
                        </div>

                        <!-- Character Options -->
                        <div class="space-y-3">
                            <div class="grid grid-cols-1 gap-3">
                                <div class="flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-200">
                                    <input type="checkbox" id="uppercase" checked 
                                           class="w-4 h-4 text-blue-600 bg-gray-100 dark:bg-gray-600 border-gray-300 dark:border-gray-500 rounded focus:ring-blue-500 transition-all duration-200">
                                    <label for="uppercase" class="text-sm text-gray-700 dark:text-gray-300 cursor-pointer">Uppercase (A-Z)</label>
                                </div>
                                <div class="flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-200">
                                    <input type="checkbox" id="lowercase" checked 
                                           class="w-4 h-4 text-blue-600 bg-gray-100 dark:bg-gray-600 border-gray-300 dark:border-gray-500 rounded focus:ring-blue-500 transition-all duration-200">
                                    <label for="lowercase" class="text-sm text-gray-700 dark:text-gray-300 cursor-pointer">Lowercase (a-z)</label>
                                </div>
                                <div class="flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-200">
                                    <input type="checkbox" id="numbers" checked 
                                           class="w-4 h-4 text-blue-600 bg-gray-100 dark:bg-gray-600 border-gray-300 dark:border-gray-500 rounded focus:ring-blue-500 transition-all duration-200">
                                    <label for="numbers" class="text-sm text-gray-700 dark:text-gray-300 cursor-pointer">Numbers (0-9)</label>
                                </div>
                                <div class="flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-200">
                                    <input type="checkbox" id="symbols" 
                                           class="w-4 h-4 text-blue-600 bg-gray-100 dark:bg-gray-600 border-gray-300 dark:border-gray-500 rounded focus:ring-blue-500 transition-all duration-200">
                                    <label for="symbols" class="text-sm text-gray-700 dark:text-gray-300 cursor-pointer">Symbols (!@#$%^&*)</label>
                                </div>
                                <div class="flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-200">
                                    <input type="checkbox" id="excludeSimilar" 
                                           class="w-4 h-4 text-blue-600 bg-gray-100 dark:bg-gray-600 border-gray-300 dark:border-gray-500 rounded focus:ring-blue-500 transition-all duration-200">
                                    <label for="excludeSimilar" class="text-sm text-gray-700 dark:text-gray-300 cursor-pointer">Exclude Similar</label>
                                </div>
                                <div class="flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-200">
                                    <input type="checkbox" id="excludeAmbiguous" 
                                           class="w-4 h-4 text-blue-600 bg-gray-100 dark:bg-gray-600 border-gray-300 dark:border-gray-500 rounded focus:ring-blue-500 transition-all duration-200">
                                    <label for="excludeAmbiguous" class="text-sm text-gray-700 dark:text-gray-300 cursor-pointer">Exclude Ambiguous</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Advanced Options -->
                    <div class="mt-6 pt-6 border-t border-gray-200 dark:border-gray-600">
                        <h3 class="text-base sm:text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4">Advance Options</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4">
                            <div class="space-y-1">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Custom Characters</label>
                                <input type="text" id="customChars" placeholder="Add custom characters" 
                                       class="w-full p-2 sm:p-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 hover:border-gray-400 dark:hover:border-gray-500">
                            </div>
                            <div class="space-y-1">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Exclude Characters</label>
                                <input type="text" id="excludeChars" placeholder="Characters to exclude" 
                                       class="w-full p-2 sm:p-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 hover:border-gray-400 dark:hover:border-gray-500">
                            </div>
                        </div>
                    </div>

                    <!-- Save to Vault -->
                    <div class="mt-6 pt-6 border-t border-gray-200 dark:border-gray-600">
                        <h4 class="text-sm sm:text-base font-medium text-gray-800 dark:text-gray-200 mb-3">Save to Vault</h4>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3">
                            <input type="text" id="appName" placeholder="App/Website name" 
                                   class="p-2 sm:p-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 hover:border-gray-400 dark:hover:border-gray-500">
                            <input type="text" id="username" placeholder="Username/Email" 
                                   class="p-2 sm:p-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 hover:border-gray-400 dark:hover:border-gray-500">
                            <button id="saveToVault" 
                                    class="px-4 py-2 sm:py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-all duration-300 flex items-center justify-center space-x-2 transform hover:scale-105 active:scale-95 shadow-md hover:shadow-lg">
                                <i class="fas fa-save text-sm"></i>
                                <span class="text-sm sm:text-base">Save</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Vault Section -->
            <div id="vaultSection" class="hidden">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 sm:p-6 animate-fade-in transition-all duration-300 hover:shadow-xl border dark:border-gray-700">
                    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 sm:mb-6 space-y-3 sm:space-y-0">
                        <h2 class="text-lg sm:text-xl font-semibold text-gray-800 dark:text-gray-100">Password Vault</h2>
                        <div class="flex flex-col sm:flex-row items-stretch sm:items-center space-y-2 sm:space-y-0 sm:space-x-3">
                            <input type="text" id="searchVault" placeholder="Search vault..." 
                                   class="px-3 sm:px-4 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 hover:border-gray-400 dark:hover:border-gray-500">
                            <button id="clearVault" 
                                    class="px-3 sm:px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all duration-300 transform hover:scale-105 active:scale-95 shadow-md hover:shadow-lg">
                                <i class="fas fa-trash mr-1 sm:mr-2 text-sm"></i>
                                <span class="text-sm">Clear All</span>
                            </button>
                        </div>
                    </div>

                    <div id="vaultEntries" class="space-y-3 sm:space-y-4">
                        <!-- Vault entries will be dynamically inserted here -->
                    </div>

                    <div id="emptyVault" class="text-center py-8 sm:py-12 text-gray-500 dark:text-gray-400">
                        <i class="fas fa-vault text-3xl sm:text-4xl mb-3 sm:mb-4 animate-bounce-in"></i>
                        <p class="text-base sm:text-lg font-medium">Your vault is empty</p>
                        <p class="text-sm mt-1">Generate and save passwords to see them here</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Toast -->
    <div id="toast" class="fixed top-4 right-4 bg-green-600 text-white px-4 sm:px-6 py-2 sm:py-3 rounded-lg shadow-lg transform translate-x-full opacity-0 transition-all duration-300 z-50">
        <div class="flex items-center space-x-2">
            <i class="fas fa-check-circle text-sm"></i>
            <span id="toastMessage" class="text-sm sm:text-base">Success!</span>
        </div>
    </div>

    <style>
        /* Enhanced slider with reduced dot size */
        .slider {
            background: transparent;
        }
        
        .slider::-webkit-slider-thumb {
            appearance: none;
            height: 18px;
            width: 18px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3B82F6, #1D4ED8);
            cursor: pointer;
            box-shadow: 0 3px 6px rgba(0,0,0,0.3);
            transition: all 0.2s ease;
            border: 2px solid white;
        }
        
        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0,0,0,0.4);
        }
        
        .slider::-moz-range-thumb {
            height: 18px;
            width: 18px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3B82F6, #1D4ED8);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 3px 6px rgba(0,0,0,0.3);
            transition: all 0.2s ease;
        }
        
        .slider::-moz-range-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0,0,0,0.4);
        }

        /* Dark mode slider thumb */
        .dark .slider::-webkit-slider-thumb {
            border: 2px solid #374151;
        }
        
        .dark .slider::-moz-range-thumb {
            border: 2px solid #374151;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .dark ::-webkit-scrollbar-track {
            background: #374151;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #3B82F6, #1D4ED8);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #1D4ED8, #1E40AF);
        }

        /* Theme transition for all elements */
        * {
            transition: background-color 300ms ease, border-color 300ms ease, color 300ms ease;
        }

        /* Enhanced mobile responsiveness */
        @media (max-width: 640px) {
            .slider::-webkit-slider-thumb {
                height: 22px;
                width: 22px;
            }
            
            .slider::-moz-range-thumb {
                height: 22px;
                width: 22px;
            }
        }

        /* Splash screen fade out animation */
        @keyframes splashFadeOut {
            from { opacity: 1; }
            to { opacity: 0; visibility: hidden; }
        }

        .splash-fade-out {
            animation: splashFadeOut 0.8s ease-in-out forwards;
        }
    </style>

    <script>
        // Initialize theme before page load
        (function() {
            try {
                const savedTheme = localStorage.getItem('passwordgen-theme');
                const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
                const theme = savedTheme || systemTheme;
                
                if (theme === 'dark') {
                    document.documentElement.classList.add('dark');
                }
            } catch (error) {
                console.log('Theme initialization error:', error);
            }
        })();

        // Splash screen handling
        window.addEventListener('load', function() {
            const splashScreen = document.getElementById('splashScreen');
            if (splashScreen) {
                setTimeout(() => {
                    splashScreen.classList.add('splash-fade-out');
                    setTimeout(() => {
                        splashScreen.style.display = 'none';
                    }, 800);
                }, 1500); // Show splash for 1.5 seconds
            }
        });

        class PasswordGenerator {
            constructor() {
                this.currentTheme = this.getInitialTheme();
                this.initializeElements();
                this.bindEvents();
                this.updateThemeIcon();
                this.loadVault();
                this.generatePassword();
                this.addSmoothInteractions();
                this.updateSliderBackground();
            }

            getInitialTheme() {
                try {
                    const savedTheme = localStorage.getItem('passwordgen-theme');
                    const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
                    return savedTheme || systemTheme;
                } catch (error) {
                    console.log('Theme detection error:', error);
                    return 'light';
                }
            }

            initializeElements() {
                // Generator elements
                this.lengthSlider = document.getElementById('lengthSlider');
                this.lengthValue = document.getElementById('lengthValue');
                this.passwordOutput = document.getElementById('passwordOutput');
                this.generateBtn = document.getElementById('generateBtn');
                this.copyBtn = document.getElementById('copyBtn');
                
                // Theme elements
                this.themeToggle = document.getElementById('themeToggle');
                this.themeIcon = document.getElementById('themeIcon');
                
                // Slider graphics elements
                this.sliderFill = document.getElementById('sliderFill');
                this.sliderBackground = document.getElementById('sliderBackground');
                
                // Options
                this.uppercase = document.getElementById('uppercase');
                this.lowercase = document.getElementById('lowercase');
                this.numbers = document.getElementById('numbers');
                this.symbols = document.getElementById('symbols');
                this.excludeSimilar = document.getElementById('excludeSimilar');
                this.excludeAmbiguous = document.getElementById('excludeAmbiguous');
                this.customChars = document.getElementById('customChars');
                this.excludeChars = document.getElementById('excludeChars');
                
                // Strength indicator
                this.strengthFill = document.getElementById('strengthFill');
                this.strengthText = document.getElementById('strengthText');
                
                // Vault elements
                this.appName = document.getElementById('appName');
                this.username = document.getElementById('username');
                this.saveToVault = document.getElementById('saveToVault');
                this.vaultEntries = document.getElementById('vaultEntries');
                this.searchVault = document.getElementById('searchVault');
                this.clearVault = document.getElementById('clearVault');
                this.emptyVault = document.getElementById('emptyVault');
                
                // Tab elements
                this.generatorTab = document.getElementById('generatorTab');
                this.vaultTab = document.getElementById('vaultTab');
                this.generatorSection = document.getElementById('generatorSection');
                this.vaultSection = document.getElementById('vaultSection');
                
                // Toast
                this.toast = document.getElementById('toast');
                this.toastMessage = document.getElementById('toastMessage');
            }

            bindEvents() {
                try {
                    // Theme toggle
                    if (this.themeToggle) {
                        this.themeToggle.addEventListener('click', () => this.toggleTheme());
                    }
                    
                    // Generator events
                    if (this.lengthSlider) {
                        this.lengthSlider.addEventListener('input', () => this.updateLength());
                    }
                    if (this.generateBtn) {
                        this.generateBtn.addEventListener('click', () => this.generatePasswordWithAnimation());
                    }
                    if (this.copyBtn) {
                        this.copyBtn.addEventListener('click', () => this.copyPassword());
                    }
                    
                    // Option change events with debouncing
                    const checkboxes = [this.uppercase, this.lowercase, this.numbers, this.symbols, 
                                       this.excludeSimilar, this.excludeAmbiguous];
                    
                    checkboxes.forEach(checkbox => {
                        if (checkbox) {
                            checkbox.addEventListener('change', () => {
                                this.debounce(() => this.generatePassword(), 100)();
                            });
                        }
                    });
                    
                    if (this.customChars) {
                        this.customChars.addEventListener('input', () => {
                            this.debounce(() => this.generatePassword(), 300)();
                        });
                    }
                    if (this.excludeChars) {
                        this.excludeChars.addEventListener('input', () => {
                            this.debounce(() => this.generatePassword(), 300)();
                        });
                    }
                    
                    // Vault events
                    if (this.saveToVault) {
                        this.saveToVault.addEventListener('click', () => this.savePasswordWithAnimation());
                    }
                    if (this.searchVault) {
                        this.searchVault.addEventListener('input', () => {
                            this.debounce(() => this.filterVault(), 200)();
                        });
                    }
                    if (this.clearVault) {
                        this.clearVault.addEventListener('click', () => this.clearAllVault());
                    }
                    
                    // Tab events
                    if (this.generatorTab) {
                        this.generatorTab.addEventListener('click', () => this.showGenerator());
                    }
                    if (this.vaultTab) {
                        this.vaultTab.addEventListener('click', () => this.showVault());
                    }

                    // Touch events for mobile
                    this.addTouchEvents();
                    
                    // Keyboard shortcuts
                    document.addEventListener('keydown', (e) => {
                        if ((e.ctrlKey || e.metaKey) && e.key === 'd') {
                            e.preventDefault();
                            this.toggleTheme();
                        }
                        if ((e.ctrlKey || e.metaKey) && e.key === 'g') {
                            e.preventDefault();
                            this.generatePasswordWithAnimation();
                        }
                    });
                } catch (error) {
                    console.error('Error binding events:', error);
                }
            }

            toggleTheme() {
                try {
                    this.currentTheme = this.currentTheme === 'light' ? 'dark' : 'light';
                    
                    if (this.themeToggle) {
                        this.themeToggle.style.animation = 'themeSwitch 0.3s ease-in-out';
                        setTimeout(() => {
                            this.themeToggle.style.animation = '';
                        }, 300);
                    }
                    
                    this.applyTheme();
                    this.updateThemeIcon();
                    
                    localStorage.setItem('passwordgen-theme', this.currentTheme);
                    this.showToast('Switched to ' + this.currentTheme + ' mode');
                } catch (error) {
                    console.error('Error toggling theme:', error);
                }
            }

            applyTheme() {
                try {
                    if (this.currentTheme === 'dark') {
                        document.documentElement.classList.add('dark');
                    } else {
                        document.documentElement.classList.remove('dark');
                    }
                } catch (error) {
                    console.error('Error applying theme:', error);
                }
            }

            updateThemeIcon() {
                try {
                    if (this.themeIcon) {
                        if (this.currentTheme === 'dark') {
                            this.themeIcon.className = 'fas fa-sun text-lg sm:text-xl transition-transform duration-300';
                        } else {
                            this.themeIcon.className = 'fas fa-moon text-lg sm:text-xl transition-transform duration-300';
                        }
                    }
                } catch (error) {
                    console.error('Error updating theme icon:', error);
                }
            }

            updateSliderBackground() {
                try {
                    if (this.lengthSlider && this.sliderFill) {
                        const value = parseInt(this.lengthSlider.value);
                        const max = parseInt(this.lengthSlider.max);
                        const min = parseInt(this.lengthSlider.min);
                        const percentage = ((value - min) / (max - min)) * 100;
                        
                        // Update fill width with single blue color
                        this.sliderFill.style.width = percentage + '%';
                        
                        // Keep it blue always
                        this.sliderFill.className = 'absolute top-0 left-0 h-3 rounded-lg transition-all duration-300 opacity-60 bg-blue-500';
                    }
                } catch (error) {
                    console.error('Error updating slider background:', error);
                }
            }

            addSmoothInteractions() {
                try {
                    // Add smooth hover effects to all buttons
                    const buttons = document.querySelectorAll('button');
                    buttons.forEach(button => {
                        button.addEventListener('mouseenter', () => {
                            if (!button.disabled) {
                                button.style.transform = 'translateY(-2px)';
                            }
                        });
                        button.addEventListener('mouseleave', () => {
                            button.style.transform = 'translateY(0)';
                        });
                    });

                    // Add smooth focus effects
                    const inputs = document.querySelectorAll('input');
                    inputs.forEach(input => {
                        input.addEventListener('focus', () => {
                            input.style.transform = 'scale(1.02)';
                        });
                        input.addEventListener('blur', () => {
                            input.style.transform = 'scale(1)';
                        });
                    });
                } catch (error) {
                    console.error('Error adding smooth interactions:', error);
                }
            }

            addTouchEvents() {
                try {
                    // Add touch feedback for mobile
                    const interactiveElements = document.querySelectorAll('button, input[type="checkbox"]');
                    interactiveElements.forEach(element => {
                        element.addEventListener('touchstart', () => {
                            element.style.transform = 'scale(0.95)';
                        });
                        element.addEventListener('touchend', () => {
                            setTimeout(() => {
                                element.style.transform = 'scale(1)';
                            }, 100);
                        });
                    });
                } catch (error) {
                    console.error('Error adding touch events:', error);
                }
            }

            debounce(func, wait) {
                let timeout;
                return function executedFunction() {
                    const later = () => {
                        clearTimeout(timeout);
                        func();
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }

            updateLength() {
                try {
                    if (this.lengthValue && this.lengthSlider) {
                        this.lengthValue.textContent = this.lengthSlider.value;
                        this.lengthValue.style.transform = 'scale(1.1)';
                        setTimeout(() => {
                            this.lengthValue.style.transform = 'scale(1)';
                        }, 150);
                    }
                    this.updateSliderBackground();
                    this.generatePassword();
                } catch (error) {
                    console.error('Error updating length:', error);
                }
            }

            async generatePasswordWithAnimation() {
                try {
                    if (this.generateBtn) {
                        this.generateBtn.innerHTML = '<i class="fas fa-spinner fa-spin text-sm"></i><span class="text-sm sm:text-base">Generating...</span>';
                        this.generateBtn.disabled = true;
                    }
                    
                    await new Promise(resolve => setTimeout(resolve, 300));
                    
                    this.generatePassword();
                    
                    if (this.generateBtn) {
                        this.generateBtn.innerHTML = '<i class="fas fa-refresh text-sm"></i><span class="text-sm sm:text-base">Generate</span>';
                        this.generateBtn.disabled = false;
                    }
                    
                    // Add success animation to password field
                    if (this.passwordOutput) {
                        this.passwordOutput.style.transform = 'scale(1.02)';
                        this.passwordOutput.classList.add('bg-green-50', 'dark:bg-green-900');
                        setTimeout(() => {
                            this.passwordOutput.style.transform = 'scale(1)';
                            this.passwordOutput.classList.remove('bg-green-50', 'dark:bg-green-900');
                        }, 300);
                    }
                } catch (error) {
                    console.error('Error generating password with animation:', error);
                    if (this.generateBtn) {
                        this.generateBtn.innerHTML = '<i class="fas fa-refresh text-sm"></i><span class="text-sm sm:text-base">Generate</span>';
                        this.generateBtn.disabled = false;
                    }
                }
            }

            generatePassword() {
                try {
                    const length = parseInt(this.lengthSlider ? this.lengthSlider.value : 12);
                    let charset = '';
                    
                    if (this.uppercase && this.uppercase.checked) charset += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
                    if (this.lowercase && this.lowercase.checked) charset += 'abcdefghijklmnopqrstuvwxyz';
                    if (this.numbers && this.numbers.checked) charset += '0123456789';
                    if (this.symbols && this.symbols.checked) charset += '!@#$%^&*()_+-=[]{}|;:,.<>?';
                    
                    if (this.customChars && this.customChars.value) charset += this.customChars.value;
                    
                    if (this.excludeSimilar && this.excludeSimilar.checked) {
                        charset = charset.replace(/[0Ol1]/g, '');
                    }
                    
                    if (this.excludeAmbiguous && this.excludeAmbiguous.checked) {
                        charset = charset.replace(/[{}[\]()\/\\'"~,;.<>]/g, '');
                    }
                    
                    if (this.excludeChars && this.excludeChars.value) {
                        const excludeRegex = new RegExp('[' + this.excludeChars.value.replace(/[.*+?^${}()|[\]\\]/g, '\\$&') + ']', 'g');
                        charset = charset.replace(excludeRegex, '');
                    }
                    
                    if (charset === '') {
                        if (this.passwordOutput) {
                            this.passwordOutput.value = 'Please select at least one character type';
                        }
                        this.updateStrengthIndicator('', 0);
                        return;
                    }
                    
                    let password = '';
                    const array = new Uint8Array(length);
                    window.crypto.getRandomValues(array);
                    
                    for (let i = 0; i < length; i++) {
                        password += charset.charAt(array[i] % charset.length);
                    }
                    
                    if (this.passwordOutput) {
                        this.passwordOutput.value = password;
                    }
                    this.updateStrengthIndicator(password, this.calculateStrength(password));
                } catch (error) {
                    console.error('Error generating password:', error);
                    if (this.passwordOutput) {
                        this.passwordOutput.value = 'Error generating password';
                    }
                }
            }

            calculateStrength(password) {
                try {
                    let score = 0;
                    
                    if (password.length >= 8) score += 20;
                    if (password.length >= 12) score += 20;
                    if (password.length >= 16) score += 20;
                    if (password.length >= 20) score += 15;
                    
                    if (/[a-z]/.test(password)) score += 5;
                    if (/[A-Z]/.test(password)) score += 5;
                    if (/[0-9]/.test(password)) score += 5;
                    if (/[^A-Za-z0-9]/.test(password)) score += 10;
                    
                    return Math.min(100, score);
                } catch (error) {
                    console.error('Error calculating strength:', error);
                    return 0;
                }
            }

            updateStrengthIndicator(password, strength) {
                try {
                    const strengthColors = {
                        0: { color: 'bg-gray-300 dark:bg-gray-600', text: 'None', textColor: 'text-gray-500 dark:text-gray-400' },
                        25: { color: 'bg-red-500', text: 'Weak', textColor: 'text-red-500' },
                        50: { color: 'bg-yellow-500', text: 'Fair', textColor: 'text-yellow-500' },
                        75: { color: 'bg-blue-500', text: 'Good', textColor: 'text-blue-500' },
                        100: { color: 'bg-green-500', text: 'Strong', textColor: 'text-green-500' }
                    };
                    
                    let strengthLevel = 0;
                    if (strength >= 80) strengthLevel = 100;
                    else if (strength >= 60) strengthLevel = 75;
                    else if (strength >= 40) strengthLevel = 50;
                    else if (strength > 0) strengthLevel = 25;
                    
                    const strengthInfo = strengthColors[strengthLevel];
                    
                    if (this.strengthFill) {
                        this.strengthFill.style.width = strength + '%';
                        this.strengthFill.className = 'h-full transition-all duration-500 ease-out ' + strengthInfo.color;
                    }
                    
                    if (this.strengthText) {
                        this.strengthText.textContent = strengthInfo.text;
                        this.strengthText.className = 'text-xs sm:text-sm font-medium ' + strengthInfo.textColor;
                    }
                } catch (error) {
                    console.error('Error updating strength indicator:', error);
                }
            }

            async copyPassword() {
                try {
                    if (this.passwordOutput && this.passwordOutput.value && this.passwordOutput.value !== 'Please select at least one character type') {
                        await navigator.clipboard.writeText(this.passwordOutput.value);
                        if (this.copyBtn) {
                            this.copyBtn.innerHTML = '<i class="fas fa-check text-sm"></i><span class="text-sm sm:text-base">Copied!</span>';
                            this.copyBtn.classList.add('bg-green-600', 'hover:bg-green-700');
                            this.copyBtn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                            
                            setTimeout(() => {
                                this.copyBtn.innerHTML = '<i class="fas fa-copy text-sm"></i><span class="text-sm sm:text-base">Copy</span>';
                                this.copyBtn.classList.remove('bg-green-600', 'hover:bg-green-700');
                                this.copyBtn.classList.add('bg-blue-600', 'hover:bg-blue-700');
                            }, 2000);
                        }
                        this.showToast('Password copied to clipboard!');
                    }
                } catch (err) {
                    console.error('Error copying password:', err);
                    this.showToast('Failed to copy password', 'error');
                }
            }

            async savePasswordWithAnimation() {
                try {
                    const password = this.passwordOutput ? this.passwordOutput.value : '';
                    const app = this.appName && this.appName.value ? this.appName.value.trim() : '';
                    const user = this.username && this.username.value ? this.username.value.trim() : '';
                    
                    if (!password || password === 'Please select at least one character type') {
                        this.showToast('Please generate a password first!', 'error');
                        return;
                    }
                    
                    if (!app) {
                        this.showToast('Please enter an app/website name!', 'error');
                        return;
                    }
                    
                    if (this.saveToVault) {
                        this.saveToVault.innerHTML = '<i class="fas fa-spinner fa-spin text-sm"></i><span class="text-sm sm:text-base">Saving...</span>';
                        this.saveToVault.disabled = true;
                    }
                    
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    const vaultEntry = {
                        id: Date.now(),
                        app: app,
                        username: user || 'N/A',
                        password: password,
                        created: new Date().toLocaleDateString(),
                        strength: this.calculateStrength(password)
                    };
                    
                    let vault = JSON.parse(localStorage.getItem('passwordVault') || '[]');
                    vault.unshift(vaultEntry);
                    localStorage.setItem('passwordVault', JSON.stringify(vault));
                    
                    if (this.appName) this.appName.value = '';
                    if (this.username) this.username.value = '';
                    this.showToast('Password saved to vault!');
                    this.renderVault();
                    
                    if (this.saveToVault) {
                        this.saveToVault.innerHTML = '<i class="fas fa-save text-sm"></i><span class="text-sm sm:text-base">Save</span>';
                        this.saveToVault.disabled = false;
                    }
                } catch (error) {
                    console.error('Error saving password:', error);
                    this.showToast('Error saving password', 'error');
                    if (this.saveToVault) {
                        this.saveToVault.innerHTML = '<i class="fas fa-save text-sm"></i><span class="text-sm sm:text-base">Save</span>';
                        this.saveToVault.disabled = false;
                    }
                }
            }

            loadVault() {
                this.renderVault();
            }

            renderVault() {
                try {
                    const vault = JSON.parse(localStorage.getItem('passwordVault') || '[]');
                    const searchTerm = this.searchVault && this.searchVault.value ? this.searchVault.value.toLowerCase() : '';
                    
                    const filteredVault = vault.filter(entry => 
                        entry.app.toLowerCase().includes(searchTerm) ||
                        entry.username.toLowerCase().includes(searchTerm)
                    );
                    
                    if (filteredVault.length === 0) {
                        if (this.emptyVault) this.emptyVault.style.display = 'block';
                        if (this.vaultEntries) this.vaultEntries.innerHTML = '';
                        return;
                    }
                    
                    if (this.emptyVault) this.emptyVault.style.display = 'none';
                    
                    if (this.vaultEntries) {
                        let entriesHtml = '';
                        for (let i = 0; i < filteredVault.length; i++) {
                            const entry = filteredVault[i];
                            entriesHtml += '<div class="bg-gray-50 dark:bg-gray-700 rounded-xl p-3 sm:p-4 transition-all duration-300 hover:shadow-md hover:bg-gray-100 dark:hover:bg-gray-600 vault-entry-enter border dark:border-gray-600" style="animation-delay: ' + (i * 0.1) + 's">';
                            entriesHtml += '<div class="flex flex-col lg:flex-row lg:items-center justify-between space-y-3 lg:space-y-0">';
                            entriesHtml += '<div class="flex-1 min-w-0">';
                            entriesHtml += '<div class="flex flex-col sm:flex-row sm:items-start sm:space-x-4">';
                            entriesHtml += '<div class="flex-1 min-w-0">';
                            entriesHtml += '<h4 class="font-medium text-gray-800 dark:text-gray-100 truncate">' + this.escapeHtml(entry.app) + '</h4>';
                            entriesHtml += '<p class="text-sm text-gray-600 dark:text-gray-300 truncate">' + this.escapeHtml(entry.username) + '</p>';
                            entriesHtml += '<p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Created: ' + entry.created + '</p>';
                            entriesHtml += '</div>';
                            entriesHtml += '<div class="flex items-center space-x-2 mt-2 sm:mt-0">';
                            entriesHtml += '<span class="text-xs font-medium text-gray-600 dark:text-gray-400">Strength:</span>';
                            entriesHtml += '<div class="w-12 sm:w-16 h-2 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden">';
                            entriesHtml += '<div class="h-full transition-all duration-500 ' + this.getStrengthColor(entry.strength) + '" style="width: ' + entry.strength + '%"></div>';
                            entriesHtml += '</div>';
                            entriesHtml += '</div>';
                            entriesHtml += '</div>';
                            entriesHtml += '</div>';
                            entriesHtml += '<div class="flex flex-wrap items-center gap-2 lg:ml-4">';
                            entriesHtml += '<input type="password" value="' + this.escapeHtml(entry.password) + '" class="w-full sm:w-32 lg:w-40 p-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-500 text-gray-800 dark:text-gray-100 rounded-lg font-mono text-xs sm:text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-200" readonly>';
                            entriesHtml += '<div class="flex space-x-2">';
                            entriesHtml += '<button onclick="window.passwordGen.togglePasswordVisibility(this)" class="px-2 sm:px-3 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-all duration-200 transform hover:scale-105"><i class="fas fa-eye text-sm"></i></button>';
                            entriesHtml += '<button onclick="window.passwordGen.copyVaultPassword(\'' + this.escapeHtml(entry.password) + '\')" class="px-2 sm:px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-all duration-200 transform hover:scale-105"><i class="fas fa-copy text-sm"></i></button>';
                            entriesHtml += '<button onclick="window.passwordGen.deleteVaultEntry(' + entry.id + ')" class="px-2 sm:px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-all duration-200 transform hover:scale-105"><i class="fas fa-trash text-sm"></i></button>';
                            entriesHtml += '</div>';
                            entriesHtml += '</div>';
                            entriesHtml += '</div>';
                            entriesHtml += '</div>';
                        }
                        this.vaultEntries.innerHTML = entriesHtml;
                    }
                } catch (error) {
                    console.error('Error rendering vault:', error);
                }
            }

            getStrengthColor(strength) {
                if (strength >= 80) return 'bg-green-500';
                if (strength >= 60) return 'bg-blue-500';
                if (strength >= 40) return 'bg-yellow-500';
                return 'bg-red-500';
            }

            togglePasswordVisibility(button) {
                try {
                    const input = button.parentElement.previousElementSibling;
                    const icon = button.querySelector('i');
                    
                    if (input && icon) {
                        if (input.type === 'password') {
                            input.type = 'text';
                            icon.className = 'fas fa-eye-slash text-sm';
                        } else {
                            input.type = 'password';
                            icon.className = 'fas fa-eye text-sm';
                        }
                    }
                } catch (error) {
                    console.error('Error toggling password visibility:', error);
                }
            }

            async copyVaultPassword(password) {
                try {
                    await navigator.clipboard.writeText(password);
                    this.showToast('Password copied!');
                } catch (err) {
                    console.error('Error copying vault password:', err);
                    this.showToast('Failed to copy password', 'error');
                }
            }

            deleteVaultEntry(id) {
                try {
                    if (confirm('Are you sure you want to delete this password?')) {
                        let vault = JSON.parse(localStorage.getItem('passwordVault') || '[]');
                        vault = vault.filter(entry => entry.id !== id);
                        localStorage.setItem('passwordVault', JSON.stringify(vault));
                        this.renderVault();
                        this.showToast('Password deleted!');
                    }
                } catch (error) {
                    console.error('Error deleting vault entry:', error);
                    this.showToast('Error deleting password', 'error');
                }
            }

            filterVault() {
                this.renderVault();
            }

            clearAllVault() {
                try {
                    if (confirm('Are you sure you want to clear all passwords? This action cannot be undone.')) {
                        localStorage.removeItem('passwordVault');
                        this.renderVault();
                        this.showToast('Vault cleared!');
                    }
                } catch (error) {
                    console.error('Error clearing vault:', error);
                    this.showToast('Error clearing vault', 'error');
                }
            }

            showGenerator() {
                try {
                    if (this.generatorTab && this.vaultTab && this.generatorSection && this.vaultSection) {
                        this.generatorTab.className = 'flex-1 py-2 sm:py-3 px-3 sm:px-6 rounded-lg bg-blue-600 text-white font-medium transition-all duration-300 transform hover:scale-105 active:scale-95';
                        this.vaultTab.className = 'flex-1 py-2 sm:py-3 px-3 sm:px-6 rounded-lg text-gray-600 dark:text-gray-300 font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-300 transform hover:scale-105 active:scale-95';
                        
                        this.vaultSection.style.display = 'none';
                        this.generatorSection.style.display = 'block';
                        this.generatorSection.className = 'space-y-4 sm:space-y-6 animate-fade-in';
                    }
                } catch (error) {
                    console.error('Error showing generator:', error);
                }
            }

            showVault() {
                try {
                    if (this.vaultTab && this.generatorTab && this.vaultSection && this.generatorSection) {
                        this.vaultTab.className = 'flex-1 py-2 sm:py-3 px-3 sm:px-6 rounded-lg bg-blue-600 text-white font-medium transition-all duration-300 transform hover:scale-105 active:scale-95';
                        this.generatorTab.className = 'flex-1 py-2 sm:py-3 px-3 sm:px-6 rounded-lg text-gray-600 dark:text-gray-300 font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-300 transform hover:scale-105 active:scale-95';
                        
                        this.generatorSection.style.display = 'none';
                        this.vaultSection.style.display = 'block';
                        this.vaultSection.className = 'animate-fade-in';
                        this.renderVault();
                    }
                } catch (error) {
                    console.error('Error showing vault:', error);
                }
            }

            showToast(message, type) {
                try {
                    if (this.toastMessage && this.toast) {
                        this.toastMessage.textContent = message;
                        this.toast.className = 'fixed top-4 right-4 px-4 sm:px-6 py-2 sm:py-3 rounded-lg shadow-lg transform transition-all duration-300 z-50 ' + (type === 'error' ? 'bg-red-600' : 'bg-green-600') + ' text-white';
                        
                        this.toast.style.transform = 'translateX(0) scale(1.1)';
                        this.toast.style.opacity = '1';
                        setTimeout(() => {
                            this.toast.style.transform = 'translateX(0) scale(1)';
                        }, 100);
                        
                        setTimeout(() => {
                            this.toast.style.transform = 'translateX(100%) scale(0.8)';
                            this.toast.style.opacity = '0';
                        }, 3000);
                    }
                } catch (error) {
                    console.error('Error showing toast:', error);
                }
            }

            escapeHtml(text) {
                try {
                    const map = {
                        '&': '&amp;',
                        '<': '&lt;',
                        '>': '&gt;',
                        '"': '&quot;',
                        "'": '&#039;'
                    };
                    return text.replace(/[&<>"']/g, function(m) { return map[m]; });
                } catch (error) {
                    console.error('Error escaping HTML:', error);
                    return text;
                }
            }
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            try {
                window.passwordGen = new PasswordGenerator();
            } catch (error) {
                console.error('Error initializing Password Generator:', error);
            }
        });
    </script>
    <script>
        if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker
      .register('/service-worker.js')
      .then(reg => console.log('Service Worker registered!', reg))
      .catch(err => console.log('Service Worker registration failed: ', err));
  });
}
    </script>
</body>
</html>
